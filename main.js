"use strict";function isDict(e){return e.constructor==Object}function getAllElementsWithDepth_(e,t,o,s){for(const r of Object.keys(e)){const n=e[r],i=s.concat([r]);0==t?o.push({keys:i,element:n}):getAllElementsWithDepth_(n,t-1,o,i)}}function getAllElementsWithDepth(e,t){const o=[];return getAllElementsWithDepth_(e,t,o,[]),o}function dictFromTwoLists(e,t){const o={};for(let s=0;s<e.length;s++)o[e[s]]=t[s];return o}class Root extends React.Component{constructor(e){super(e),this.state={board:void 0,config_text:void 0,config:{players:["white","black"],board:[],cell:["x","y"],figures:{intellector:{movement:[{x:1,also_reversed:!0},{y:1,also_reversed:!0},{x:1,y:-1,also_reversed:!0}]},defensor:{movement:[{x:1,also_reversed:!0},{y:1,also_reversed:!0},{x:1,y:-1,also_reversed:!0}]},dominator:{movement:[{x:1,repeat:!0,also_reversed:!0},{y:1,repeat:!0,also_reversed:!0},{x:1,y:-1,repeat:!0,also_reversed:!0}]},aggressor:{movement:[{x:1,y:1,repeat:!0,also_reversed:!0},{x:1,y:-1,repeat:!0,also_reversed:!0},{x:-1,y:1,repeat:!0,also_reversed:!0}]},liberator:{movement:[{x:2,also_reversed:!0,jump:!0},{y:2,also_reversed:!0,jump:!0},{x:2,y:-2,also_reversed:!0,jump:!0}]},progressor:{movement:{white:[{x:1},{y:1},{x:-1,y:1}],black:[{x:-1},{y:-1},{x:1,y:-1}]}}},initial_position:{white:{intellector:[{x:4,y:-2}],dominator:[{x:0,y:0},{x:8,y:-4}],agressor:[{x:2,y:-1},{x:6,y:-3}],defensor:[{x:3,y:-1},{x:5,y:-2}],liberator:[{x:1,y:0},{x:7,y:-3}],progressor:[{x:0,y:1},{x:2,y:0},{x:4,y:-1},{x:6,y:-2},{x:8,y:-3}]},black:{intellector:[{x:4,y:4}],dominator:[{x:0,y:6},{x:8,y:2}],agressor:[{x:2,y:5},{x:6,y:3}],defensor:[{x:3,y:4},{x:5,y:3}],liberator:[{x:1,y:5},{x:7,y:2}],progressor:[{x:0,y:5},{x:2,y:4},{x:4,y:3},{x:6,y:2},{x:8,y:1}]}}}};for(let e=0;e<9;e++)for(let t=0-Math.floor(e/2);t<7-e%2-Math.floor(e/2);t++)this.state.config.board.push({x:e,y:t});this.state.config_text=JSON.stringify(this.state.config),this.state.board=this.placeFiguresOnBoard(this.state.config.cell,this.state.config.initial_position,this.state.config.board)}onConfigTextChange(e){const t=e.target.value;this.setState({config_text:t})}insertByCoordinates(e,t,o,s){const r=e.map((e=>t[e]));let n=o;for(let e=0;e<r.length-1;e++){const t=r[e];n[t]||(n[t]={}),n=n[t]}n[r[r.length-1]]=s}placeFiguresOnBoard(e,t,o){const s={};for(const t of o)this.insertByCoordinates(e,t,s,{});for(const o in t)for(const r in t[o])for(const n of t[o][r])this.insertByCoordinates(e,n,s,{player:o,figure:r});return s}unpackBoard(e,t){return getAllElementsWithDepth(this.state.board,e.length-1).map((t=>Object.assign({},t.element,dictFromTwoLists(e,t.keys))))}compile(){const e=JSON.parse(this.state.config_text);this.state.config&&this.setState({config:e,position:e.initial_position,board:this.placeFiguresOnBoard(e.cell,e.initial_position,e.board)})}render(){const e=this.unpackBoard(this.state.config.cell,this.state.board);return React.createElement("div",{className:"app"},React.createElement(Board,{board:e}),React.createElement("div",{className:"config"},React.createElement("textarea",{className:"configText",value:JSON.stringify(this.state.config,null,"\t"),onChange:this.onConfigTextChange.bind(this)}),React.createElement("button",{className:"compileButton",onClick:this.compile.bind(this)},"compile")))}}const rootElement=document.getElementById("root");ReactDOM.render(React.createElement(Root),rootElement);